
**Метод найменших квадратів (МНК)** — це математичний метод для знаходження найкращої лінії (або кривої), що описує залежність між даними.

**Головна ідея:** знайти таку пряму, щоб сума квадратів відхилень від неї до всіх точок даних була мінімальною.

## Формула

Для лінійної регресії $y = ax + b$:

$$a = \frac{n\sum xy - \sum x \sum y}{n\sum x^2 - (\sum x)^2}$$

$$b = \frac{\sum y - a\sum x}{n}$$

де $n$ — кількість точок.

## Приклад: залежність ціни від площі квартири

### Початкові дані
| Площа (м²) | Ціна (тис. $) |
|------------|---------------|
| 40 | 80 |
| 50 | 95 |
| 60 | 110 |
| 70 | 120 |
| 80 | 140 |

### Розрахунок
$n = 5$

Обчислюємо суми:
- $\sum x = 40 + 50 + 60 + 70 + 80 = 300$
- $\sum y = 80 + 95 + 110 + 120 + 140 = 545$
- $\sum xy = 40 \cdot 80 + 50 \cdot 95 + ... = 34350$
- $\sum x^2 = 40^2 + 50^2 + ... = 19000$

Знаходимо коефіцієнти:

$$a = \frac{5 \cdot 34350 - 300 \cdot 545}{5 \cdot 19000 - 300^2} = \frac{171750 - 163500}{95000 - 90000} = \frac{8250}{5000} = 1.65$$

$$b = \frac{545 - 1.65 \cdot 300}{5} = \frac{545 - 495}{5} = 10$$

### Результат
$$y = 1.65x + 10$$

**Інтерпретація:** 

- Кожен додатковий квадратний метр додає **1.65 тис. $** до ціни
- Базова вартість (умовна) становить **10 тис. $**

### Перевірка

Для квартири 60 м²:
$$y = 1.65 \cdot 60 + 10 = 99 + 10 = 109 \text{ тис. \$}$$

Реальне значення: 110 тис. $ → помилка лише 1 тис. $

## Чому саме квадрати?

| Підхід | Проблема |
|--------|----------|
| Мінімізувати просто відхилення | Позитивні та негативні помилки взаємно скасовуються |
| Мінімізувати модулі відхилень | Математично складніше; не дає єдиного рішення |
| Мінімізувати квадрати відхилень | ✓ Великі помилки караються сильніше; має аналітичне рішення |

## Геометричне тлумачення

> МНК знаходить пряму, що мінімізує суму квадратів **вертикальних** відстаней від точок до прямої.

## Обмеження

- **Чутливість до викидів** — одна екстремальна точка може значно зміщувати пряму
- **Лише лінійні залежності** — базовий МНК не працює для нелінійних зв'язків
- **Припущення про помилки** — передбачає, що помилки розподілені нормально

## Ключові висновки

> МНК дає оптимальну пряму в сенсі мінімізації квадратичної помилки.

- **Аналітичне рішення** — можна обчислити точно за формулами
- **Математична простота** — лінійна алгебра дає елегантне рішення
- **Широке застосування** — основа для багатьох методів регресії